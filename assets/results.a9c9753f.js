import"./modulepreload-polyfill.b7f2da20.js";import{f as b,g as D,a as L,t as x,b as B,e as T}from"./sheets-api.2d2ad60f.js";let v=[],I=[];window.changeColumn=function(c){if(!c)return;const l=new URL(window.location.href);l.searchParams.set("column",c),window.location.href=l.toString()};document.addEventListener("DOMContentLoaded",function(){const c=new URLSearchParams(window.location.search),l=c.get("id"),p=c.get("column"),f=document.getElementById("info-banner"),y=document.getElementById("sheet-info");if(!l){h("No spreadsheet ID provided. Please go back and enter a valid Google Sheets URL.");return}y.textContent=`Spreadsheet ID: ${l.substring(0,8)}...`,E(l,p);async function E(t,n){try{const e=await b(t),d=await D(t);document.querySelector("#title").innerText=d,document.querySelector("#src-google-sheet").innerHTML=`
                    Source google sheet: 
                    <a target="_blank" href="https://docs.google.com/spreadsheets/d/${t}">https://docs.google.com/spreadsheets/d/${t}</a>
                    `;const o=(await L(t))[0],a=e.values;if(!a||a.length<2)throw new Error("Not enough data in the spreadsheet or the spreadsheet is empty.");const i=a[0];v=i;const u=x(a);I=u;let r=null;if(n){if(r=B(i,n),!r)throw new Error(`Column "${n}" not found in the spreadsheet.`)}else r=i.find(S=>u.slice(0,5).map(m=>m[S]).some(m=>m&&m.length>20)),r||(r=i[0]);const g=T(u,r);document.getElementById("loading").style.display="none",f.innerHTML=`
                        <strong>Sheet:</strong> ${o} &nbsp; | &nbsp;
                        <strong>Column:</strong> ${r} &nbsp; | &nbsp;
                        <strong>Total Responses:</strong> ${g.length}
                    `,w(i,r),C(g)}catch(e){console.error("Error loading sheet data:",e),h(e.message||"Failed to load spreadsheet data")}}function w(t,n){const e=document.getElementById("column-select"),d=document.getElementById("column-selector-container");e.innerHTML="",t.forEach(s=>{const o=document.createElement("option");o.value=s,o.textContent=s,o.selected=s===n,e.appendChild(o)}),d.style.display="flex"}function C(t){const n=document.getElementById("response-list");n.innerHTML="",t.forEach((e,d)=>{const s=document.createElement("div");s.className="response-item";const o=document.createElement("div");o.className="response-content",o.textContent=e.text;const a=document.createElement("div");a.className="response-meta",a.textContent=`Response #${d+1} \u2022 ${e.date}`,s.appendChild(o),s.appendChild(a),n.appendChild(s)})}function h(t){document.getElementById("loading").style.display="none";const n=document.getElementById("error-container"),e=document.getElementById("error-message");e.textContent=t,n.style.display="block"}});
